"use strict";(self.webpackChunkmmsp_station=self.webpackChunkmmsp_station||[]).push([[75472],{2144:(e,t,n)=>{n.d(t,{b:()=>a});var i=n(18690),r=n(54901),s=n(50346),o=n(75540);class a{constructor(){this._currentOperationSignal=(0,o.v)(null)}get currentOperationType(){return this._currentOperationSignal.value?.type??null}destroy(){this.stop()}async start(e,t,n){const o=this._currentOperationSignal.value;o?.stop();const a=new AbortController,l=n?.signal,u=AbortSignal.any([a.signal,l].filter(i.Ru)),c=(0,s.Tw)();let p=!1;const h=()=>{p||(p=!0,c.reject((0,s.NK)()))},d={type:e,resolve:e=>{p||(p=!0,c.resolve(e))},reject:h,promise:c.promise,stop:()=>a.abort(),handles:[]};this._currentOperationSignal.value=d,d.handles.push((0,s.u7)(l,()=>{a.abort()}),(0,s.u7)(u,()=>{(0,r.a0)(d.handles),p||h()}));try{return o&&(await o.promise.catch(()=>{}),(0,s.Te)(u)),await t(d,u),await c.promise}finally{(0,r.a0)(d.handles),this._currentOperationSignal.value===d&&(this._currentOperationSignal.value=null)}}stop(){this._currentOperationSignal.value?.stop()}}},38983:(e,t,n)=>{function i(e,t,n){n=n||2;var i,s,a,l,u,c,h,d=t&&t.length,y=d?t[0]*n:e.length,v=r(e,0,y,n,!0),f=[];if(!v||v.next===v.prev)return f;if(d&&(v=p(e,t,v,n)),e.length>80*n){i=a=e[0],s=l=e[1];for(var g=n;g<y;g+=n)(u=e[g])<i&&(i=u),(c=e[g+1])<s&&(s=c),u>a&&(a=u),c>l&&(l=c);h=0!==(h=Math.max(a-i,l-s))?1/h:0}return o(v,f,n,i,s,h),f}function r(e,t,n,i,r){var s,o;if(r===T(e,t,n,i)>0)for(s=t;s<n;s+=i)o=P(s,e[s],e[s+1],o);else for(s=n-i;s>=t;s-=i)o=P(s,e[s],e[s+1],o);if(o&&C(o,o.next)){var a=o.next;k(o),o=a}return o}function s(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!C(i,i.next)&&0!==w(i.prev,i,i.next))i=i.next;else{var r=i.prev;if(k(i),(i=t=r)===i.next)break;n=!0}}while(n||i!==t);return t}function o(e,t,n,i,r,p,h){if(e){!h&&p&&f(e,i,r,p);for(var d,y,v=e;e.prev!==e.next;)if(d=e.prev,y=e.next,p?l(e,i,r,p):a(e))t.push(d.i/n),t.push(e.i/n),t.push(y.i/n),k(e),e=y.next,v=y.next;else if((e=y)===v){h?1===h?o(e=u(s(e),t,n),t,n,i,r,p,2):2===h&&c(e,t,n,i,r,p):o(s(e),t,n,i,r,p,1);break}}}function a(e){var t=e.prev,n=e,i=e.next;if(w(t,n,i)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(x(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&w(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function l(e,t,n,i){var r=e.prev,s=e,o=e.next;if(w(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,l=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,u=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,c=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,p=g(a,l,t,n,i),h=g(u,c,t,n,i),d=e.prevZ,y=e.nextZ;d&&d.z>=p&&y&&y.z<=h;){if(d!==e.prev&&d!==e.next&&x(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,y!==e.prev&&y!==e.next&&x(r.x,r.y,s.x,s.y,o.x,o.y,y.x,y.y)&&w(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;d&&d.z>=p;){if(d!==e.prev&&d!==e.next&&x(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;y&&y.z<=h;){if(y!==e.prev&&y!==e.next&&x(r.x,r.y,s.x,s.y,o.x,o.y,y.x,y.y)&&w(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function u(e,t,n){var i=e;do{var r=i.prev,o=i.next.next;!C(r,o)&&M(r,i,i.next,o)&&R(r,o)&&R(o,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(o.i/n),k(i),k(i.next),i=e=o),i=i.next}while(i!==e);return s(i)}function c(e,t,n,i,r,a){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&_(l,u)){var c=Z(l,u);return l=s(l,l.next),c=s(c,c.next),o(l,t,n,i,r,a),void o(c,t,n,i,r,a)}u=u.next}l=l.next}while(l!==e)}function p(e,t,n,i){var o,a,l,u=[];for(o=0,a=t.length;o<a;o++)(l=r(e,t[o]*i,o<a-1?t[o+1]*i:e.length,i,!1))===l.next&&(l.steiner=!0),u.push(m(l));for(u.sort(h),o=0;o<u.length;o++)n=s(n=y(u[o],n),n.next);return n}function h(e,t){return e.x-t.x}function d(e){if(e.next.prev===e)return e;let t=e;for(;;){const n=t.next;if(n.prev===t||n===t||n===e)break;t=n}return t}function y(e,t){var n=function(e,t){var n,i=t,r=e.x,s=e.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>o){if(o=a,a===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===o)return n;var l,u=n,c=n.x,p=n.y,h=1/0;i=n;do{r>=i.x&&i.x>=c&&r!==i.x&&x(s<p?r:o,s,c,p,s<p?o:r,s,i.x,i.y)&&(l=Math.abs(s-i.y)/(r-i.x),R(i,e)&&(l<h||l===h&&(i.x>n.x||i.x===n.x&&v(n,i)))&&(n=i,h=l)),i=i.next}while(i!==u);return n}(e,t);if(!n)return t;var i=Z(n,e),r=s(n,n.next);let o=d(i);return s(o,o.next),r=d(r),d(t===n?r:t)}function v(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function f(e,t,n,i){var r=e;do{null===r.z&&(r.z=g(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,n,i,r,s,o,a,l,u=1;do{for(n=e,e=null,s=null,o=0;n;){for(o++,i=n,a=0,t=0;t<u&&(a++,i=i.nextZ);t++);for(l=u;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;n=i}s.nextZ=null,u*=2}while(o>1)}(r)}function g(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function m(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function x(e,t,n,i,r,s,o,a){return(r-o)*(t-a)-(e-o)*(s-a)>=0&&(e-o)*(i-a)-(n-o)*(t-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function _(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&M(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(R(e,t)&&R(t,e)&&function(e,t){var n=e,i=!1,r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||C(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function C(e,t){return e.x===t.x&&e.y===t.y}function M(e,t,n,i){var r=S(w(e,t,n)),s=S(w(e,t,i)),o=S(w(n,i,e)),a=S(w(n,i,t));return r!==s&&o!==a||!(0!==r||!b(e,n,t))||!(0!==s||!b(e,i,t))||!(0!==o||!b(n,e,i))||!(0!==a||!b(n,t,i))}function b(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function S(e){return e>0?1:e<0?-1:0}function R(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function Z(e,t){var n=new E(e.i,e.x,e.y),i=new E(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function P(e,t,n,i){var r=new E(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function k(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function E(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(e,t,n,i){for(var r=0,s=t,o=n-i;s<n;s+=i)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}n.d(t,{e:()=>i}),i.deviation=function(e,t,n,i){var r=t&&t.length,s=r?t[0]*n:e.length,o=Math.abs(T(e,0,s,n));if(r)for(var a=0,l=t.length;a<l;a++){var u=t[a]*n,c=a<l-1?t[a+1]*n:e.length;o-=Math.abs(T(e,u,c,n))}var p=0;for(a=0;a<i.length;a+=3){var h=i[a]*n,d=i[a+1]*n,y=i[a+2]*n;p+=Math.abs((e[h]-e[y])*(e[d+1]-e[h+1])-(e[h]-e[d])*(e[y+1]-e[h+1]))}return 0===o&&0===p?0:Math.abs((p-o)/o)},i.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},i=0,r=0;r<e.length;r++){for(var s=0;s<e[r].length;s++)for(var o=0;o<t;o++)n.vertices.push(e[r][s][o]);r>0&&(i+=e[r-1].length,n.holes.push(i))}return n}},40615:(e,t,n)=>{n.d(t,{Q:()=>g});var i=n(6326),r=n(91967),s=n(68134),o=n(46053),a=(n(81806),n(76460),n(47249),n(87990)),l=n(45564),u=n(69098),c=n(56002),p=n(19247),h=n(57919),d=n(31633);function y(e,t,n){return null==e?null:(0,d.oU)(e*t,"meters",n)}function v(e,t,n){return null==e?null:(0,d.oU)(e*t,"meters",n)}let f=class extends u.Pw{constructor(e){super(e),this._getSamplesMemoized=(0,c.B)((e,t)=>function(e,t){if(null==e||null==t)return null;const{samples:n,spatialReference:i}=e,{distance:r,elevation:s}=t,o=(0,d.GA)(i),a=(0,d.G9)(i),l=n.length,u=new Array(l);for(let c=0;c<l;++c){const e=n[c],t=e.sampledZ,i=e.coordinate;u[c]={x:i[0],y:i[1],z:t,distance:y(e.distance,o,r),elevation:v(t,a,s)}}return u}(e,t)),this._getStatisticsMemoized=(0,c.B)((e,t)=>function(e,t){if(null==e||null==t||null==e.statistics||null==e.spatialReference)return null;const{distance:n,elevation:i}=t,{statistics:r,spatialReference:s}=e,o=(0,d.GA)(s),a=(0,d.G9)(s);return{maxDistance:y(r.maxDistance,o,n),minElevation:v(r.minElevation,a,i),maxElevation:v(r.maxElevation,a,i),avgElevation:v(r.avgElevation,a,i),elevationGain:v(r.elevationGain,a,i),elevationLoss:v(r.elevationLoss,a,i),maxPositiveSlope:r.maxPositiveSlope,maxNegativeSlope:r.maxNegativeSlope,avgPositiveSlope:r.avgPositiveSlope,avgNegativeSlope:r.avgNegativeSlope}}(e,t)),this.rawResult=null}get available(){const{computation:e}=this;return e.profile.enabled&&e.available}get profile(){return this.computation.profile}get progress(){return(0,h.xi)(null!=this.rawResult&&this.computation.profile.enabled?this.rawResult.progress:0)}get samples(){return this._getSamplesMemoized(this.rawResult,this.computation.controller.effectiveDisplayUnits)}get statistics(){return this._getStatisticsMemoized(this.rawResult,this.computation.controller.effectiveDisplayUnits)}get hoveredPoint(){if(!this.computation.profile.enabled)return null;const e=this.computation.controller.analysisViewData.hoveredPosition;if(null==e)return null;const{rawResult:t,samples:n}=this;if(null==n||null==t)return null;const i=n.length;if(0===i)return null;const r=n[i-1].distance,s=(0,h.qX)(n,e*r,e=>e.distance);if(null==s)return null;const{x:o,y:a,z:l}=s;return null==l?null:new p.A({x:o,y:a,z:l,spatialReference:t.spatialReference})}};(0,i.Cg)([(0,o.MZ)()],f.prototype,"available",null),(0,i.Cg)([(0,o.MZ)({readOnly:!0})],f.prototype,"profile",null),(0,i.Cg)([(0,o.MZ)({readOnly:!0})],f.prototype,"progress",null),(0,i.Cg)([(0,o.MZ)()],f.prototype,"samples",null),(0,i.Cg)([(0,o.MZ)()],f.prototype,"statistics",null),(0,i.Cg)([(0,o.MZ)({constructOnly:!0})],f.prototype,"computation",void 0),(0,i.Cg)([(0,o.MZ)()],f.prototype,"rawResult",void 0),(0,i.Cg)([(0,o.MZ)()],f.prototype,"hoveredPoint",null),f=(0,i.Cg)([(0,a.$)("esri.views.analysis.ElevationProfile.ElevationProfileResult")],f);let g=class extends r.A{constructor(e){super(e),this.result=new f({computation:this}),this.numSamplesForPreview=30,this.numSamplesPerChunk=200}initialize(){this.addHandles([(0,s.wB)(()=>{const{geometry:e,elevationInfo:t}=this.controller.analysis;return[e,t]},()=>this.onInvalidate(this),s.OH)])}setResult(e){this.result.rawResult=e}clearResult(){this.setResult(null)}get progress(){return this.result.progress}get hoveredPoint(){return this.result.hoveredPoint}get available(){return!0}get minDemResolution(){return(0,l.zj)().defaultDemResolution}};(0,i.Cg)([(0,o.MZ)({constructOnly:!0})],g.prototype,"controller",void 0),(0,i.Cg)([(0,o.MZ)({constructOnly:!0})],g.prototype,"profile",void 0),(0,i.Cg)([(0,o.MZ)({constructOnly:!0})],g.prototype,"onInvalidate",void 0),(0,i.Cg)([(0,o.MZ)()],g.prototype,"result",void 0),(0,i.Cg)([(0,o.MZ)({readOnly:!0})],g.prototype,"progress",null),(0,i.Cg)([(0,o.MZ)()],g.prototype,"hoveredPoint",null),(0,i.Cg)([(0,o.MZ)()],g.prototype,"available",null),(0,i.Cg)([(0,o.MZ)()],g.prototype,"numSamplesForPreview",void 0),(0,i.Cg)([(0,o.MZ)()],g.prototype,"numSamplesPerChunk",void 0),(0,i.Cg)([(0,o.MZ)({readOnly:!0})],g.prototype,"minDemResolution",null),g=(0,i.Cg)([(0,a.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineComputation")],g)},42151:(e,t,n)=>{n.d(t,{E5:()=>h,ZP:()=>f});var i=n(18690),r=n(94967),s=n(99809),o=n(60008),a=n(4336),l=n(20664),u=n(9392),c=n(19247);function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=n?[e,t,n]:[e,t]}function h(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=n?{x:e,y:t,z:n}:{x:e,y:t}}class d{constructor(e){this.spatialReference=e}mapToLocalMultiple(e){return e.map(e=>this.mapToLocal(e)).filter(i.Ru)}get doUnnormalization(){return!1}}class y extends d{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(t),this._defaultZ=n,this.transform=(0,s.vt)(),this.transformInv=(0,s.vt)(),this.transform=(0,s.o8)(e),(0,r.B8)(this.transformInv,this.transform)}makeMapPoint(e,t){return p(e,t,this._defaultZ)}mapToLocal(e){return h(this.transform[0]*e[0]+this.transform[2]*e[1]+this.transform[4],this.transform[1]*e[0]+this.transform[3]*e[1]+this.transform[5])}localToMap(e){return p(this.transformInv[0]*e.x+this.transformInv[2]*e.y+this.transformInv[4],this.transformInv[1]*e.x+this.transformInv[3]*e.y+this.transformInv[5],this._defaultZ)}}class v extends d{constructor(e,t){super(e.spatialReference),this.view=e,this.defaultZ=null,this.pWS=(0,u.vt)(),this.tangentFrameUpWS=(0,u.vt)(),this.tangentFrameRightWS=(0,u.vt)(),this.tangentFrameForwardWS=(0,u.vt)(),this.localFrameRightWS=(0,u.vt)(),this.localFrameUpWS=(0,u.vt)(),this.worldToLocalTransform=(0,a.vt)(),this.localToWorldTransform=(0,a.vt)(),this.scale=1,this.scale=e.resolution,this.referenceMapPoint=t,this.defaultZ=t.hasZ?t.z:null;const n=e.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,0,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,1,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,2,this.tangentFrameForwardWS);const i=(0,u.vt)();(0,l.h)(i,this.tangentFrameForwardWS,(0,l.f)(n,this.tangentFrameForwardWS)),(0,l.e)(this.localFrameRightWS,n,i),(0,l.n)(this.localFrameRightWS,this.localFrameRightWS),(0,l.i)(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),(0,o.Yc)(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),(0,o.B8)(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(e,t){return p(e,t,this.defaultZ)}mapToLocal(e){const t=(0,u.vt)();this.view.renderCoordsHelper.toRenderCoords(new c.A({x:e[0],y:e[1],spatialReference:this.spatialReference}),t),(0,l.v)(t,t,this.worldToLocalTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(t,new c.A({spatialReference:this.view.spatialReference}));return null!=n?h(n.x/this.scale,n.y/this.scale):null}localToMap(e){const t=(0,u.vt)();this.view.renderCoordsHelper.toRenderCoords(new c.A({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),t),(0,l.v)(t,t,this.localToWorldTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(t,new c.A({spatialReference:this.view.spatialReference}));return null!=n?p(n.x,n.y,this.defaultZ):null}}function f(e,t){if("2d"===e.type)return new y(e.state.transform,e.spatialReference,t.length>2?t[2]:null);if("3d"===e.type){const n=t.length>2?new c.A({x:t[0],y:t[1],z:t[2],spatialReference:e.spatialReference}):new c.A({x:t[0],y:t[1],spatialReference:e.spatialReference});return new v(e,n)}return null}},43825:(e,t,n)=>{n.d(t,{V:()=>P});var i=n(6326),r=n(91967),s=n(18690),o=n(98773),a=n(80674),l=n(54901),u=n(53084),c=n(53521),p=n(43927),h=n(30726),d=n(50346),y=n(68134),v=n(79468),f=n(31633),g=n(46053),m=(n(81806),n(76460),n(87990)),x=n(71630),_=n(12482),w=n(19747),C=n(731),M=n(45564),b=n(27631),S=n(47453),R=n(57919),Z=n(80397);let P=class extends r.A{constructor(e){super(e),this.error=null,this._getStableEffectiveUnits=(0,a.f)(()=>{const e=(0,Z.DM)(this._activeComputations.map(e=>e.result.rawResult)),t=this.analysis.displayUnits,n=(0,w.c)(this.view);return{distance:(0,f.Vs)(e.maxDistance,"meters",t.distance??n),elevation:(0,f.jE)(e.maxElevation,"meters",t.elevation??n)}},u.gh),this._updateTask=null,this._queue=null,this._currentTileCache=null,this._parametersPerComputation=new Map,this._getStableUpdateParameters=(0,a.f)(()=>({stationary:this.view.stationary??!0,activeComputations:this._activeComputations,generationParameters:this._generationParameters}),u.gh),this._getStableGenerationParameters=(0,a.f)(()=>{const{view:e,analysis:t}=this;return e?.ready&&this._queue?{view:e,geometry:t.geometry,geometryIsValid:t.valid,elevationInfo:this.elevationInfo,queue:this._queue,cache:this._tileCache,options:this._options,slicePlane:"3d"===e.type?e.slice.plane:null}:null},u.gh),this._getStableElevationInfo=(0,a.f)(()=>this.analysis.elevationInfo??k,h.CM),this._getStableOptions=(0,a.f)(()=>{const{densificationMaxSamples:e,defaultDemResolution:t,maxTotalSamples:n}=(0,M.zj)();let i=this._minDemResolution??t;return i=parseFloat(i.toFixed(2)),{samplingDistance:i,densificationMaxSamples:Math.round(e/this._activeComputations.length),maxTotalSamples:n}},u.gh),this._updateThrottled=(0,v.n)(e=>this._update(e),(0,M.zj)().updateThrottleMillis)}initialize(){this._computationsCollection=(0,p.L)(()=>this.analysis.profiles,e=>this.computationFactory.create({controller:this,profile:e,onInvalidate:e=>this._invalidateComputation(e)}),{recycleItems:!0}),this.addHandles([this._computationsCollection.on("change",()=>{this._parametersPerComputation.clear(),this._updateThrottled(this._updateParameters)}),(0,y.wB)(()=>this._updateParameters,e=>this._updateThrottled(e),y.pc),this._updateThrottled]);const e="3d"===this.view.type?this.view.resourceController:void 0;this._queue=(0,R.LD)(e?.scheduler),e?.addUpdatingObject(this)}destroy(){this._abortUpdate(),this._parametersPerComputation.clear(),this._computationsCollection?.destroy(),this._queue=(0,h.pR)(this._queue),this._currentTileCache=(0,h.pR)(this._currentTileCache)}get effectiveDisplayUnits(){return this._getStableEffectiveUnits()}get progress(){let e=0,t=0;for(const n of this._activeComputations)e++,t+=n.progress;return(0,R.xi)(e>0?t/e:0)}get updating(){const{progress:e}=this,t=!!this._queue?.updating,n=this._updateThrottled.hasPendingUpdates(),i=null!=this._updateTask&&!this._updateTask.finished;return t||n||i||e>0&&e<1}get results(){return this._computations.map(e=>e.result)}get statistics(){return(0,Z.ch)(this._activeComputations.map(e=>e.result.statistics))}get hoveredPoints(){return this._computations.map(e=>e.hoveredPoint)}onElevationChange(e){const{view:t}=this;return"3d"===t?.type?(0,y.on)(()=>t.elevationProvider,"elevation-change",e,{onListenerAdd:e,onListenerRemove:e}):(0,l.hA)()}get _tileCache(){this._currentTileCache=(0,h.pR)(this._currentTileCache);const e=this.view;if("3d"===e?.type){const t=e.basemapTerrain?.elevationQueryCache;if(null!=t)return t}return null==this._currentTileCache&&(this._currentTileCache=new x.E(new c.q(20971520))),this._currentTileCache}get _computations(){return this._computationsCollection?.toArray()??[]}get _activeComputations(){return this._computations.filter(e=>e.profile.enabled&&e.available)}get _minDemResolution(){const e=this._minDemResolutions;return e.length>0?(0,s.jk)(e):null}get _minDemResolutions(){const e=[];for(const{minDemResolution:t}of this._activeComputations)null!=t&&e.push(t);return e}get _updateParameters(){return this._getStableUpdateParameters()}get _generationParameters(){return this._getStableGenerationParameters()}get elevationInfo(){return this._getStableElevationInfo()}get _options(){return this._getStableOptions()}_update(e){let{stationary:t,activeComputations:n,generationParameters:i}=e;this._abortUpdate(),t&&(null!=i?this._updateTask=(0,o.UT)(async e=>{this.error=null;const t=n.filter(e=>!this._isComputationValid(e,i));try{if(!i.geometryIsValid)throw new S.ON;const n=(0,R.uK)({...i,providers:t},{signal:e});let r=!1;for await(const s of n){(0,d.Te)(e),r||(this._clearInvalidResults(i),r=!0);for(let e=0;e<t.length;e++)t[e].setResult(s[e])}for(const e of t)this._parametersPerComputation.set(e,i)}catch(r){(0,d.QP)(r),this._abortUpdate(),this.error=r instanceof b.A?r:new S.Bk,t.forEach(e=>{e.clearResult()})}}):this._clearResults())}_abortUpdate(){this._updateTask=(0,h.DC)(this._updateTask)}_isComputationValid(e,t){return this._parametersPerComputation.has(e)&&this._parametersPerComputation.get(e)===t}_invalidateComputation(e){this._parametersPerComputation.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const t of this._computations)this._isComputationValid(t,e)||(t.clearResult(),this._parametersPerComputation.delete(t))}_clearResults(){for(const e of this._computations)e.clearResult(),this._parametersPerComputation.delete(e)}};(0,i.Cg)([(0,g.MZ)({constructOnly:!0})],P.prototype,"analysis",void 0),(0,i.Cg)([(0,g.MZ)({constructOnly:!0})],P.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,g.MZ)({constructOnly:!0})],P.prototype,"computationFactory",void 0),(0,i.Cg)([(0,g.MZ)({constructOnly:!0})],P.prototype,"view",void 0),(0,i.Cg)([(0,g.MZ)()],P.prototype,"error",void 0),(0,i.Cg)([(0,g.MZ)({readOnly:!0})],P.prototype,"effectiveDisplayUnits",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"progress",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"updating",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"results",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"statistics",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"hoveredPoints",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"_updateTask",void 0),(0,i.Cg)([(0,g.MZ)()],P.prototype,"_queue",void 0),(0,i.Cg)([(0,g.MZ)()],P.prototype,"_tileCache",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"_computationsCollection",void 0),(0,i.Cg)([(0,g.MZ)()],P.prototype,"_computations",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"_activeComputations",null),(0,i.Cg)([(0,g.MZ)({readOnly:!0})],P.prototype,"_minDemResolution",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"_minDemResolutions",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"_updateParameters",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"_generationParameters",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"elevationInfo",null),(0,i.Cg)([(0,g.MZ)()],P.prototype,"_options",null),P=(0,i.Cg)([(0,m.$)("esri.views.analysis.ElevationProfile.ElevationProfileController")],P);const k=new C.A({..._.qt})},48384:(e,t,n)=>{n.d(t,{zV:()=>L,zd:()=>U,eq:()=>k,N6:()=>T,LZ:()=>E,_T:()=>G,GF:()=>A});var i,r=n(18690),s=n(53084),o=n(31633),a=n(20664),l=n(9392),u=n(6326),c=n(46053),p=(n(81806),n(76460),n(47249),n(87990)),h=n(34111),d=n(19247),y=n(65215),v=n(13312),f=n(7137),g=n(45417),m=n(85996);let x=i=class extends y.A{constructor(e){super(e),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}initialize(){const e=this.center,t=this.numberOfPoints;if(this.hasZ=e?.hasZ??!1,0!==this.rings.length||!e)return;const n=(0,o.oU)(this.radius,this.radiusUnit,"meters"),i=e.spatialReference;let r,s="geographic";if(i.isWebMercator?s="webMercator":(null!=(i.wkid&&m.A[i.wkid])||(i.wkt2||i.wkt)&&(0,o.x1)(i.wkt2||i.wkt))&&(s="projected"),this.geodesic){let i;switch(s){case"webMercator":i=(0,g.ci)(e);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":i=e}r=this._createGeodesicCircle(i,n,t),"webMercator"===s&&(r=(0,g.Gh)(r))}else{let i;"webMercator"===s||"projected"===s?i=n/(0,o.Ao)(e.spatialReference):"geographic"===s&&(i=(0,o.vl)(n,"meters",(0,h.tO)(e.spatialReference).radius)),r=this._createPlanarCircle(e,i,t)}this.spatialReference=r.spatialReference,this.addRing(r.rings[0])}clone(){const{center:e,numberOfPoints:t,radius:n,radiusUnit:r,geodesic:s}=this;return new i({center:e?.clone(),numberOfPoints:t,radius:n,radiusUnit:r,geodesic:s})}_createGeodesicCircle(e,t,n){const i=[],r=[e.x,e.y];for(let s=0;s<360;s+=360/n){const n=this.hasZ?[0,0,e.z??0]:[0,0];(0,f.vN)(n,r,s,t,v.A.WGS84),i.push(n)}return i.push(i[0]),new y.A({rings:[i]})}_createPlanarCircle(e,t,n){const i=[],r=2*Math.PI/n;for(let s=0;s<n;++s){const n=r*s,o=[e.x+Math.cos(-n)*t,e.y+Math.sin(-n)*t];this.hasZ&&o.push(e.z??0),i.push(o)}return i.push(i[0]),new y.A({spatialReference:e.spatialReference,rings:[i]})}};(0,u.Cg)([(0,c.MZ)({type:d.A})],x.prototype,"center",void 0),(0,u.Cg)([(0,c.MZ)()],x.prototype,"geodesic",void 0),(0,u.Cg)([(0,c.MZ)()],x.prototype,"numberOfPoints",void 0),(0,u.Cg)([(0,c.MZ)()],x.prototype,"radius",void 0),(0,u.Cg)([(0,c.MZ)()],x.prototype,"radiusUnit",void 0),x=i=(0,u.Cg)([(0,p.$)("esri.geometry.Circle")],x);const _=x;var w=n(66388),C=n(23701),M=n(1736),b=n(78496),S=n(5262),R=n(80963),Z=n(42151);function P(e,t){const n=new d.A({x:e[0],y:e[1],spatialReference:t});return e.length>2&&(n.z=e[2]),n}function k(e,t){return new w.A({points:e,spatialReference:t})}function E(e,t,n){const i=new C.A({paths:e,spatialReference:t});return n&&(0,S._7)(i),i}function T(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const o=(0,s.o8)(e);o.forEach(e=>{const t=e[0],n=e[e.length-1];(0,r.aI)(t,n)&&1!==e.length||e.push(e[0])});let a=new y.A({rings:o,spatialReference:t});return a.rings.forEach(e=>{(0,S.$3)(e)||e.reverse()}),n&&(0,S._7)(a),i&&!(0,b.i)(a)&&(0,R.fn)(t)&&(a=(0,b.e)(a)||a),a}function A(e,t,n){const i=t.mapToLocalMultiple(e),s=[],o={x:i[0].x,y:i[0].y},a=i[1].x,l=i[1].y,u=Math.round(a-o.x),c=Math.round(l-o.y),p=Math.max(Math.abs(u),Math.abs(c));if(n){const e={x:o.x+p,y:o.y+p},t={x:o.x-p,y:o.y-p};s.push((0,Z.E5)(e.x,t.y),(0,Z.E5)(t.x,t.y),(0,Z.E5)(t.x,e.y),(0,Z.E5)(e.x,e.y))}else{const e={x:u>0?o.x+p:o.x-p,y:c>0?o.y+p:o.y-p};s.push((0,Z.E5)(o.x,o.y),(0,Z.E5)(e.x,o.y),(0,Z.E5)(e.x,e.y),(0,Z.E5)(o.x,e.y))}return z(T([s.map(e=>t.localToMap(e)).filter(r.Ru)],t.spatialReference,t.doUnnormalization,!0),s,t)}function G(e,t,n){let i=t.mapToLocalMultiple(e);if(1===i.length){const e=48,t=i[0];i=[(0,Z.E5)(t.x-e,t.y+e),(0,Z.E5)(t.x+e,t.y-e),(0,Z.E5)(t.x+e,t.y-e),(0,Z.E5)(t.x-e,t.y+e)]}const s=[],o={x:i[0].x,y:i[0].y},a={x:i[1].x,y:i[1].y};if(n){const e=Math.round(a.x-o.x),t=Math.round(a.y-o.y);s.push((0,Z.E5)(o.x-e,o.y-t),(0,Z.E5)(a.x,o.y-t),(0,Z.E5)(a.x,a.y),(0,Z.E5)(o.x-e,a.y))}else s.push((0,Z.E5)(o.x,o.y),(0,Z.E5)(a.x,o.y),(0,Z.E5)(a.x,a.y),(0,Z.E5)(o.x,a.y));return z(T([s.map(e=>t.localToMap(e)).filter(r.Ru)],t.spatialReference,t.doUnnormalization,!0),s,t)}function z(e,t,n){const i=I(t[3],t[2],n),r=I(t[1],t[2],n),s=I(t[0],t[1],n),o=I(t[0],t[3],n);return{geometry:e,midpoints:null!=i&&null!=r&&null!=s&&null!=o?{top:i,right:r,bottom:s,left:o}:null}}function I(e,t,n){D[0]=e.x,D[1]=e.y,D[2]=0,V[0]=t.x,V[1]=t.y,V[2]=0,(0,a.l)(D,D,V,.5),O.x=D[0],O.y=V[1],O.z=V[2];const i=n.localToMap(O);return null!=i?P(i,n.spatialReference):null}const O=(0,Z.E5)(0,0,0),D=(0,l.vt)(),V=(0,l.vt)();function L(e,t,n,i){const r=t.mapToLocalMultiple(e);let s=null,a=null;if(n)s=r[0],a=r[1];else{const e=r[0],t=r[1],n=Math.round(t.x-e.x),i=Math.round(t.y-e.y),o=Math.max(Math.abs(n),Math.abs(i));s=(0,Z.E5)(n>0?e.x+o/2:e.x-o/2,i>0?e.y+o/2:e.y-o/2),a=(0,Z.E5)(Math.abs(n)>Math.abs(i)?s.x-o/2:s.x,Math.abs(n)>Math.abs(i)?s.y:s.y-o/2)}const l=t.localToMap(s),u=t.localToMap(a);if(null==l||null==u)return null;t.doUnnormalization&&(0,S.JM)([[l,u]],t.spatialReference);const c=P(l,t.spatialReference),p=P(u,t.spatialReference),h=(0,o.GA)(t.spatialReference);let d=0;if((0,R.fn)(t.spatialReference))d=h*(0,M.e)(c,p);else{const e=s.x-a.x,t=s.y-a.y;d=h*Math.sqrt(e*e+t*t)*(i||1)}const y=new _({center:c,radius:d,radiusUnit:"meters",spatialReference:t.spatialReference});return{geometry:T(y.rings,y.spatialReference,!1),center:c,edge:p}}function U(e,t,n){const i=t.mapToLocalMultiple(e),s=i[0],o=i[1],a=Math.round(o.x-s.x),l=Math.round(o.y-s.y),u=(0,Z.E5)(n?s.x:s.x+a/2,n?s.y:s.y+l/2),c=n?a:a/2,p=n?l:l/2,h=[],d=2*Math.PI/60;function y(e){const t=Math.cos(e),n=Math.sin(e);return(0,Z.E5)(c*t+u.x,p*n+u.y)}for(let r=0;r<60;r++)h.push(y(r*d));h.push(h[0]);const{spatialReference:v,doUnnormalization:f}=t,g=T([h.map(e=>t.localToMap(e)).filter(r.Ru)],v,f,!1),m=t.localToMap(y(Math.PI/2)),x=t.localToMap(y(0)),_=t.localToMap(y(-Math.PI/2)),w=t.localToMap(y(Math.PI));return{geometry:g,midpoints:null!=m&&null!=x&&null!=_&&null!=w?{top:P(m,v),right:P(x,v),bottom:P(_,v),left:P(w,v)}:null}}},49636:(e,t,n)=>{n.d(t,{s:()=>u});var i=n(6326),r=n(68134),s=n(46053),o=(n(81806),n(76460),n(47249),n(87990)),a=n(40615),l=n(61607);let u=class extends a.Q{constructor(){super(...arguments),this.type="query",this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return(0,l.e)(this.profile.source)}get available(){const{source:e}=this.profile;return!!e&&(null==e.visible||e.visible)&&(null==e.layers||e.layers.some(e=>e.visible))}initialize(){this.addHandles((0,r.wB)(()=>this.profile.source,()=>this.onInvalidate(this),r.OH))}queryElevation(e,t){if(!this.profile.source)throw new Error("No source configured for the elevation profile line");return this.profile.source.queryElevation(e,t)}};(0,i.Cg)([(0,s.MZ)({readOnly:!0})],u.prototype,"minDemResolution",null),(0,i.Cg)([(0,s.MZ)()],u.prototype,"available",null),u=(0,i.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineQueryComputation")],u)},49853:(e,t,n)=>{n.d(t,{a:()=>u});var i=n(6326),r=n(54099),s=n(54901),o=n(91291),a=n(46053),l=(n(81806),n(76460),n(47249),n(87990));let u=class extends((0,o.g)(r.nJ)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(e){this._userInteractive=e}get updating(){return!1}get visible(){return(this.parent?.visible&&!this.parent.suspended)??!0}set visible(e){this._overrideIfSome("visible",e)}forceInteractive(){return this._interactiveViewModelCount++,(0,s.hA)(()=>this._interactiveViewModelCount--)}};(0,i.Cg)([(0,a.MZ)({constructOnly:!0})],u.prototype,"parent",void 0),(0,i.Cg)([(0,a.MZ)({constructOnly:!0})],u.prototype,"view",void 0),(0,i.Cg)([(0,a.MZ)({type:Boolean})],u.prototype,"interactive",null),(0,i.Cg)([(0,a.MZ)()],u.prototype,"_userInteractive",void 0),(0,i.Cg)([(0,a.MZ)({readOnly:!0})],u.prototype,"updating",null),(0,i.Cg)([(0,a.MZ)()],u.prototype,"visible",null),(0,i.Cg)([(0,a.MZ)()],u.prototype,"_interactiveViewModelCount",void 0),u=(0,i.Cg)([(0,l.$)("esri.views.analysis.AnalysisView")],u)},50360:(e,t,n)=>{n.d(t,{Pg:()=>l,fz:()=>u,g7:()=>o,zo:()=>a});var i=n(68707),r=(n(97799),n(63331),n(56175));n(91523);const s=new r.D;function o(e,t,n){return s.execute(e,t,n,null)}function a(e,t,n){const r=s.executeMany(new i.S(e),t,n,null);return Array.from(r)}function l(e,t,n){return s.isSimpleAsFeature(e,t,n,null,null)}function u(){return s.supportsCurves()}},55980:(e,t,n)=>{n.d(t,{T:()=>r});var i=n(48384);function r(e,t){e??=[];const n=e.length-1,r=[];let s=[];for(let i=0;i<=n;i++){const{x:t,y:o,z:a}=e[i];null!=a&&s.push([t,o,a]),i!==n&&null!=a||!s.length||(r.push(s),s=[])}return(0,i.LZ)(r,t,!0)}},61607:(e,t,n)=>{n.d(t,{W:()=>a,e:()=>o});var i=n(18690),r=n(31633),s=n(97153);function o(e){if(null==e)return null;if((0,s.Q)(e))return a(e);const t=e.tileInfo;if(null==t)return null;const n=t.lods?.at(-1);return null==n?null:n.resolution*(0,r.GA)(t.spatialReference)}function a(e){if(null==e)return null;const t=e.layers.items.map(l).filter(i.Ru);return(0,i.jk)(t)??null}function l(e){return e&&"tileInfo"in e?o(e):null}},62068:(e,t,n)=>{n.d(t,{o:()=>d});var i=n(6326),r=n(80674),s=n(53084),o=n(30726),a=n(68134),l=n(46053),u=(n(81806),n(76460),n(87990)),c=n(62078),p=n(80635),h=n(40615);let d=class extends h.Q{constructor(){super(...arguments),this.type="input",this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this._getStableElevationDependencies=(0,r.f)(()=>{const{view:e}=this.controller;if(!e)return null;const t=this._getStableElevationInfo();return{view:e,stationary:!this._requiresElevationAlignment||e.stationary,elevationInfo:t,visibleLayerIds:this._getStableLayerIds(),spatialReference:this._getStableSpatialReference()}},s.gh),this._getStableElevationInfo=(0,r.f)(()=>this.controller.elevationInfo,o.CM),this._getStableSpatialReference=(0,r.f)(()=>this.controller.view?.spatialReference,o.CM),this._getStableLayerIds=(0,r.f)(()=>{const{view:e}=this.controller;return"3d"!==e.type?[]:(0,p.Y)(e)},s.gh)}initialize(){const e=()=>this.onInvalidate(this);this.addHandles([(0,a.wB)(()=>this._queryElevationDependencies,e,a.OH),this.controller.onElevationChange(e)])}async queryElevation(e,t){let{noDataValue:n,signal:i}=t;const r=this._queryElevationDependencies;if(null==r)throw new Error(`${this.declaredClass}: no dependencies`);const{view:s,spatialReference:o}=r;if(this._requiresElevationAlignment&&"3d"===s.type&&o){const t=await c.q.fromGeometry(e).project(o,i);if(!t)return{geometry:e,noDataValue:n};const r=s.elevationProvider;return t.coordinates.forEach(e=>{e.z=r.getElevation(e.x,e.y,0,o,"ground")??0}),{geometry:t.export(),noDataValue:n}}return{geometry:e,noDataValue:n}}get _requiresElevationAlignment(){return"on-the-ground"===this.controller.elevationInfo?.mode&&"3d"===this.controller.view.type}get _queryElevationDependencies(){return this._getStableElevationDependencies()}};(0,i.Cg)([(0,l.MZ)()],d.prototype,"_queryElevationDependencies",null),d=(0,i.Cg)([(0,u.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineInputComputation")],d)},71143:(e,t,n)=>{n.d(t,{R:()=>S});var i=n(6326),r=n(39356),s=n(91967),o=n(98773),a=n(19276),l=(n(81806),n(54901)),u=n(30726),c=n(50346),p=n(68134),h=n(46053),d=(n(76460),n(47249),n(87990)),y=n(19451),v=n(63733),f=n(12482),g=n(89465),m=n(7246),x=n(731),_=n(2144),w=n(55964),C=n(57308),M=n(81335),b=n(18279);let S=class extends s.A{constructor(e){super(e),this._sketchViewModels=new a.A,this._updatingHandles=new y.U,this._operationManager=new _.b}initialize(){const{view:e}=this;this._graphicsLayer=new v.A({listMode:"hide",internal:!0}),this.addHandles([(0,p.wB)(()=>({map:e.map,internalGraphicsLayer:this._graphicsLayer,state:this.state,geometryVisualizationVisible:this._analysis.viewOptions.geometryVisualizationVisible,visible:this.analysisViewData.visible}),e=>{let{map:t,internalGraphicsLayer:n,state:i,geometryVisualizationVisible:r,visible:s}=e;!function(e,t){t&&(t.removeFromParent(),e?.add(t))}(t,n);const o=this.sketchGraphic;switch(o&&(o.visible=s),i){case"idle":case"reshaping-disabled":o&&!r&&(o.visible=!1),this._operationManager.stop(),this._ensureUpdatedSketchGraphic();break;case"reshaping":(0,c.QZ)(this._startReshape());break;case"awaiting-sketch":this.analysisViewData.interactive=!0}},p.pc),(0,p.wB)(()=>this._analysis.elevationInfo,e=>{this._graphicsLayer.elevationInfo=e},p.pc)])}destroy(){this._operationManager.destroy(),this._sketchViewModels.drain(e=>(0,u.pR)(e));const e=this._graphicsLayer;this.view.map?.remove(e),e.destroy()}get sketchGraphic(){return this._get("sketchGraphic")}set sketchGraphic(e){e!==this._get("sketchGraphic")&&(this._set("sketchGraphic",e),this._updateAnalysisFromSketchGraphic())}get state(){const{visible:e,interactive:t}=this.analysisViewData;if(!e)return"idle";switch(this._operationManager.currentOperationType){case"place":return this._sketching?"sketching":"awaiting-sketch";case"pick-feature":return"picking";default:return this._analysis.geometry?t?"reshaping":"reshaping-disabled":"idle"}}get updating(){return this._sketchViewModels.some(e=>e.updating)||this._updatingHandles.updating}get _sketching(){return this._sketchViewModels.some(e=>e.createGraphic===this.sketchGraphic)}get _analysis(){return this.analysisViewData.analysis}get _lineSymbol(){return function(e){if("2d"===e){const e={type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5};return new g.A({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{...e,effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],color:[0,0,0,255]},{...e,color:[255,255,255,255]}]}}})}return new m.A({color:[0,0,0,0]})}(this.view.type)}place(e){return this._operationManager.start("place",async t=>{const n=this._createSketchViewModel(),i=this._analysis.clone();this._ensureUpdatedSketchGraphic();const r=this.sketchGraphic,s=this._analysis.elevationInfo,o=(0,l.hA)(()=>{this.sketchGraphic===r&&(this._graphicsLayer.elevationInfo=s)}),a=n.on("create",e=>{switch(e.state){case"start":this._graphicsLayer.removeAll(),this.sketchGraphic=e.graphic,this._analysis.elevationInfo=this._graphicsLayer.elevationInfo;break;case"active":this._updateAnalysisFromSketchGraphic();break;case"complete":this.sketchGraphic&&(this._updateAnalysisFromSketchGraphic(),this._addSketchGraphic(this.sketchGraphic)),t.stop();break;case"cancel":t.stop()}});t.handles.push(a,(0,l.hA)(()=>(a.remove(),n.destroy(),this._sketchViewModels.remove(n),this._updateAnalysisFromSketchGraphic(),this._analysis.valid?(0,c.G4)(e)||i.equals(this._analysis)?t.reject():void t.resolve({}):(this._clear(),t.reject()))),o),this._graphicsLayer.elevationInfo=R,await this._updatingHandles.addPromise((0,c.QZ)(n.create("polyline")))},e)}async pickFeature(e){return this._operationManager.start("pick-feature",async e=>{const{view:t}=this;t.closePopup();let n=null;e.handles.push(t.on("immediate-click",i=>{i.defer(async()=>{n?.abort(),n=(0,o.UT)(async n=>{const{results:r}=await t.hitTest(i);(0,c.Te)(n);let s=null;for(const e of r)if("graphic"===e.type&&(0,w.lM)(e.graphic)&&!(0,w._W)(e.graphic)){s=e.graphic;break}s?(i.preventDefault(),i.stopPropagation(),this.sketchGraphic=null,this._analysis.geometry=s.geometry,this._analysis.elevationInfo=new x.A({...(0,f.bh)(s)}),e.resolve({feature:s}),e.stop()):e.reject()}),await n.promise})},C.oj.TOOL),t.on("key-down",t=>{(0,M.$X)(t)&&(e.reject(),e.stop())},C.oj.TOOL),t.acquireCursor("crosshair","high"),(0,l.hA)(()=>{n?.abort(),e.reject()})),t.focus()},e)}_startReshape(){const e=this._createSketchViewModel();return this._sketchViewModels.add(e),this._operationManager.start("reshape",async t=>{const n=()=>{const t=this._ensureUpdatedSketchGraphic();return t?this._updatingHandles.addPromise(e.update(t,{tool:"reshape"})):Promise.resolve()};if(!this._ensureUpdatedSketchGraphic())return;const i=e.on("update",e=>{this._updateAnalysisFromSketchGraphic(),"complete"===e.state&&("reshaping"===this.state?(0,c.QZ)(n()):t.resolve())});t.handles.push(i,(0,l.hA)(()=>{i.remove(),this._sketchViewModels.remove(e),e.destroy(),t.resolve()})),await n()})}_createSketchViewModel(){return new b.A({layer:this._graphicsLayer,view:this.view,defaultCreateOptions:{mode:"click",hasZ:!0},updateOnGraphicClick:!1,defaultUpdateOptions:{enableMoveAllGraphics:!1,enableRotation:!1,enableScaling:!1,enableZ:!1,highlightOptions:{enabled:!1},multipleSelectionEnabled:!1,reshapeOptions:{shapeOperation:"none"},toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:this._lineSymbol,activeLineSymbol:this._lineSymbol})}_ensureUpdatedSketchGraphic(){const{geometry:e}=this._analysis;if(!e)return this.sketchGraphic=null,this._graphicsLayer.removeAll(),null;const t=this.sketchGraphic??=new r.A({symbol:this._lineSymbol,geometry:e});return t.geometry=e,this._addSketchGraphic(t),t}_addSketchGraphic(e){const{graphics:t}=this._graphicsLayer;t.includes(e)||t.add(e),1!==t.length&&t.removeMany(t.filter(t=>t!==e))}_clear(){this.sketchGraphic=null,this._analysis.clear()}_updateAnalysisFromSketchGraphic(){let e=this.sketchGraphic?.geometry;(0,w.Rg)(e)||(e=null);const t=this._analysis;t.geometry!==e&&(t.geometry=e)}};(0,i.Cg)([(0,h.MZ)({constructOnly:!0})],S.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,h.MZ)({constructOnly:!0})],S.prototype,"view",void 0),(0,i.Cg)([(0,h.MZ)()],S.prototype,"sketchGraphic",null),(0,i.Cg)([(0,h.MZ)({nonNullable:!0})],S.prototype,"state",null),(0,i.Cg)([(0,h.MZ)()],S.prototype,"updating",null),(0,i.Cg)([(0,h.MZ)()],S.prototype,"_sketching",null),(0,i.Cg)([(0,h.MZ)()],S.prototype,"_analysis",null),(0,i.Cg)([(0,h.MZ)()],S.prototype,"_lineSymbol",null),S=(0,i.Cg)([(0,d.$)("esri.views.analysis.ElevationProfile.ElevationProfileTool")],S);const R=new x.A({mode:"on-the-ground",offset:0})},73520:(e,t,n)=>{n.d(t,{V:()=>s});var i=n(54901),r=n(68134);function s(e){return(0,i.vE)([(0,r.wB)(()=>{const{analysis:t,sketchGraphic:n,toolState:i,visible:r}=e.analysisViewData,{geometryVisualizationVisible:s}=t.viewOptions;return{geometryVisualizationVisible:s,geometry:t.geometry,sketchGraphic:n,toolState:i,visible:r}},t=>{let{geometryVisualizationVisible:n,sketchGraphic:i,toolState:r,visible:s}=t;if(e.remove(),s)return n&&null!=i&&"reshaping"!==r&&"sketching"!==r?e.show(i):void 0},r.pc)])}},78496:(e,t,n)=>{n.d(t,{a:()=>o,b:()=>l,e:()=>s,i:()=>a,s:()=>u});var i=n(50360),r=n(58067);function s(e){const t=(0,r.getSpatialReference)(e);return(0,r.toGeometry)((0,i.g7)((0,r.fromGeometry)(e),(0,r.fromSpatialReference)(t),!1),t)}function o(e){const t=e.map(r.fromGeometry),n=(0,r.getSpatialReference)(e);return(0,i.zo)(t,(0,r.fromSpatialReference)(n),!1).map(e=>(0,r.toGeometry)(e,n))}function a(e){return(0,i.Pg)((0,r.fromGeometry)(e),(0,r.fromSpatialReference)((0,r.getSpatialReference)(e)),!1)}const l=(0,i.fz)(),u=Object.freeze(Object.defineProperty({__proto__:null,execute:s,executeMany:o,isSimple:a,supportsCurves:l},Symbol.toStringTag,{value:"Module"}))},79468:(e,t,n)=>{n.d(t,{n:()=>r});var i=n(75540);function r(e,t,n,r){let s=null,o=1e3;"number"==typeof t?(o=t,r=n):(s=t??null,o=n);const a=(0,i.v)(0);let l;const u=()=>{a.value=0,e.apply(r,l)},c=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];s&&s.apply(r,t),l=t,o?a.value||(a.value=setTimeout(u,o)):u()};return c.remove=()=>{a.value&&(clearTimeout(a.value),a.value=0)},c.forceUpdate=()=>{a.value&&(clearTimeout(a.value),u())},c.hasPendingUpdates=()=>!!a.value,c}},80635:(e,t,n)=>{function i(e){return e?.map?.allLayers?.toArray().filter(e=>("graphics"!==e.type||!e.internal)&&e.visible).map(e=>e.uid)??[]}n.d(t,{Y:()=>i})},80674:(e,t,n)=>{function i(e,t){let n,i=!1;return function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];const a=e.apply(this,s);return i&&void 0!==n&&t?.(n,a)?n:(i=!0,n=a,a)}}n.d(t,{f:()=>i})},82185:(e,t,n)=>{n.d(t,{R:()=>h});var i=n(6326),r=n(80674),s=n(53084),o=n(68134),a=n(31633),l=n(46053),u=(n(81806),n(76460),n(87990)),c=n(40615),p=n(61607);let h=class extends c.Q{constructor(){super(...arguments),this.type="ground",this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getStableQueryElevationDependencies=(0,r.f)(()=>({ground:this._ground,groundLayers:this._getStableGroundLayers()}),s.gh),this._getStableGroundLayers=(0,r.f)(()=>this._ground?.layers?.toArray(),s.gh)}get minDemResolution(){return(0,p.W)(this._ground)}get available(){return!0===this._ground?.layers.some(e=>e.visible)}initialize(){this.addHandles([(0,o.wB)(()=>this._queryElevationDependencies,()=>this.onInvalidate(this))])}async queryElevation(e,t){const n=this._queryElevationDependencies;if(null==n)throw new Error(`${this.declaredClass}: no dependencies`);const{ground:i}=n;if(null==i)throw new Error("No ground configured in the view");const r=await i.queryElevation(e,t),s=(0,a.G9)(e.spatialReference),o=(0,a.G9)(i.layers.at(0).spatialReference);if(s!==o){const e=r.geometry;e.points=e.points.map(e=>{let[n,i,r]=e;return[n,i,r===t.noDataValue?r:r*o/s]})}return r}get _queryElevationDependencies(){return this._getStableQueryElevationDependencies()}get _ground(){return this.controller.view?.map?.ground}};(0,i.Cg)([(0,l.MZ)()],h.prototype,"minDemResolution",null),(0,i.Cg)([(0,l.MZ)()],h.prototype,"available",null),(0,i.Cg)([(0,l.MZ)()],h.prototype,"_queryElevationDependencies",null),(0,i.Cg)([(0,l.MZ)()],h.prototype,"_ground",null),h=(0,i.Cg)([(0,u.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineGroundComputation")],h)},94656:(e,t,n)=>{n.d(t,{n:()=>d});var i=n(6326),r=n(91967),s=n(19276),o=n(68134),a=n(46053),l=(n(81806),n(76460),n(47249),n(87990)),u=n(69539),c=n(56611),p=n(45564);let h=class extends r.A{constructor(e){super(e),this.position=null,this.color=new u.A("#ffffff"),this.element=function(){const e=document.createElement("div"),{size:t,borderStyle:n,borderColor:i,borderWidth:r,boxShadow:s}=(0,p.zj)().hoveredPointsStyle,{style:o}=e;return o.display="block",o.position="absolute",o.top="0",o.left="0",o.contain="strict",o.boxSizing="border-box",o.width=`${t}px`,o.height=`${t}px`,o.marginTop=`-${t/2}px`,o.marginLeft=`-${t/2}px`,o.border=`${n} ${r}px ${i}`,o.borderRadius=`${t}px`,o.boxShadow=s,e}()}initialize(){this.addHandles([(0,o.wB)(()=>this._screenLocation,e=>{e&&(this.element.style.transform=`translate(${e.x}px, ${e.y}px)`)},o.pc),(0,o.wB)(()=>this.color.toCss(),e=>{this.element.style.background=e},o.pc)]),this.view.surface?.appendChild(this.element)}destroy(){this.element.remove()}get _screenLocation(){const{position:e,view:t}=this;"3d"===t.type?(t.commitProperty("size"),t.commitProperty("camera")):t.commitProperty("center");const n=t?.spatialReference,i=n?(0,c.projectOrLoad)(e,n).geometry:null;return i&&t?.ready?t.toScreen(i):null}};(0,i.Cg)([(0,a.MZ)()],h.prototype,"position",void 0),(0,i.Cg)([(0,a.MZ)({type:u.A})],h.prototype,"color",void 0),(0,i.Cg)([(0,a.MZ)()],h.prototype,"view",void 0),(0,i.Cg)([(0,a.MZ)()],h.prototype,"_screenLocation",null),h=(0,i.Cg)([(0,l.$)("esri.views.analysis.ElevationProfile.ElevationProfileHoveredPointVisualization")],h);let d=class extends r.A{constructor(e){super(e),this._hoveredPoints=new s.A}initialize(){const{analysisViewData:e}=this,{analysis:t}=e;this.addHandles([(0,o.wB)(()=>{const{hoveredPoints:n,visible:i,updating:r}=e;return i?r?null:n.map((e,n)=>{const i=t.profiles.at(n);return!0===i?.viewOptions.hoveredPointVisible&&null!=e?{hoveredPoint:e,color:i.color}:null}).filter(e=>!!e):[]},e=>this._update(e),o.pc),(0,o.wB)(()=>t.geometry,()=>this._update([]),o.pc)])}destroy(){this._hoveredPoints.drain(e=>e.destroy())}get updating(){return!1}_update(e){if(!e)return;const{view:t,_hoveredPoints:n}=this,i=e.length;for(;n.length>i;)n.pop()?.destroy();for(;n.length<i;){const e=new h({view:t});n.push(e)}for(let r=0;r<i;++r){const t=e[r],s=n.at(i-1-r);s.position=t.hoveredPoint,s.color=t.color}}};(0,i.Cg)([(0,a.MZ)()],d.prototype,"view",void 0),(0,i.Cg)([(0,a.MZ)()],d.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,a.MZ)()],d.prototype,"_hoveredPoints",void 0),(0,i.Cg)([(0,a.MZ)()],d.prototype,"updating",null),d=(0,i.Cg)([(0,l.$)("esri.views.analysis.ElevationProfile.ElevationProfileHoveredPointsVisualization")],d)}}]);
//# sourceMappingURL=75472.22e0289a.chunk.js.map