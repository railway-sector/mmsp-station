"use strict";(self.webpackChunkmmsp_station=self.webpackChunkmmsp_station||[]).push([[11668,62544],{11668:(e,r,a)=>{a.d(r,{K:()=>p,Q:()=>i});var t=a(53986),l=a(31933),n=a(67061);const o=["loadContext"],s=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function i(e,r){var a,s;const i=r||{},{loadContext:u}=i,c=(0,t.A)(i,o),d=u?await u.fetchServiceMetadata(e,c):await(0,n.V)(e,c),v=(0,l.G$)();f(d),y(d);const p={serviceJSON:d,preferredHost:v};if((null!==(a=d.currentVersion)&&void 0!==a?a:0)<10.5)return p;const m="".concat(null!==(s=(0,l.$x)())&&void 0!==s?s:e,"/layers"),w=u?await u.fetchServiceMetadata(m,c):await(0,n.V)(m,c);return f(w),y(w),p.layersJSON={layers:w.layers,tables:w.tables},p}function u(e){const{type:r}=e;return!!r&&s.has(r)}function c(e){return"Table"===e.type}function y(e){var r,a;e.layers=null===(r=e.layers)||void 0===r?void 0:r.filter(u),e.tables=null===(a=e.tables)||void 0===a?void 0:a.filter(c)}function d(e){e.type||(e.type="Feature Layer")}function v(e){e.type||(e.type="Table")}function f(e){var r,a;null!==(r=e.layers)&&void 0!==r&&r.forEach(d),null===(a=e.tables)||void 0===a||a.forEach(v)}function p(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}},62544:(e,r,a)=>{a.r(r),a.d(r,{fromUrl:()=>v});var t=a(89379),l=a(50076),n=a(90534),o=a(13096),s=a(39323),i=a(11668),u=a(31933),c=a(62487),y=a(67061);const d={FeatureLayer:!0,SceneLayer:!0,VideoLayer:!0};async function v(e){const{properties:r,url:c}=e,v=(0,t.A)((0,t.A)({},r),{},{url:c}),S=await async function(e,r){let a=(0,o.qg)(e);if(null==a&&(a=await async function(e,r){var a,t;const l=await(0,y.V)(e,{customParameters:r});let s=null,i=null;const u=l.type;if("Feature Layer"===u||"Table"===u?(s="FeatureServer",i=null!==(a=l.id)&&void 0!==a?a:null):"indexedVector"===u?s="VectorTileServer":l.hasOwnProperty("mapName")?s="MapServer":l.hasOwnProperty("bandCount")&&l.hasOwnProperty("pixelSizeX")?s="ImageServer":l.hasOwnProperty("maxRecordCount")&&l.hasOwnProperty("allowGeometryUpdates")?s="FeatureServer":l.hasOwnProperty("streamUrls")?s="StreamServer":m(l)?(s="SceneServer",i=l.id):l.hasOwnProperty("layers")&&m(null===(t=l.layers)||void 0===t?void 0:t[0])&&(s="SceneServer"),!s)return null;const c=null!=i?(0,o.iz)(e):null;return{title:null!=c&&l.name||(0,n.e7)(e),serverType:s,sublayer:i,url:{path:null!=c?c.serviceUrl:(0,n.An)(e).path}}}(e,r)),null==a)throw new l.A("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e});const{serverType:t,sublayer:c}=a;let v;const f={FeatureServer:"FeatureLayer",KnowledgeGraphServer:"KnowledgeGraphLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer",VideoServer:"VideoLayer"},p="FeatureServer"===t,S="SceneServer"===t,b={parsedUrl:a,Constructor:null,layerId:(p||S)&&null!==c&&void 0!==c?c:void 0,layers:[],tables:[]};switch(t){case"MapServer":if(null!=c){const{type:a}=await(0,y.V)(e,{customParameters:r});switch(v="FeatureLayer",a){case"Catalog Layer":v="CatalogLayer";break;case"Catalog Dynamic Group Layer":throw new l.A("arcgis-layers:unsupported",'fromUrl() not supported for "'.concat(a,'" layers'))}}else v=await async function(e,r){return(await(0,y.V)(e,{customParameters:r})).tileInfo}(e,r)?"TileLayer":"MapImageLayer";break;case"ImageServer":{var h;const a=await(0,y.V)(e,{customParameters:r}),{tileInfo:t,cacheType:l}=a;v=t?"LERC"!==(null===t||void 0===t||null===(h=t.format)||void 0===h?void 0:h.toUpperCase())||l&&"elevation"!==l.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{const e=await(0,y.V)(a.url.path,{customParameters:r});if(v="SceneLayer",e){const r=null===e||void 0===e?void 0:e.layers;if("Voxel"===(null===e||void 0===e?void 0:e.layerType))v="VoxelLayer";else if(null!==r&&void 0!==r&&r.length){var L;const e=null===(L=r[0])||void 0===L?void 0:L.layerType;null!=e&&null!=u.XX[e]&&(v=u.XX[e])}}break}case"3DTilesServer":throw new l.A("arcgis-layers:unsupported","fromUrl() not supported for 3DTiles layers");case"FeatureServer":if(v="FeatureLayer",null!=c){const a=await(0,y.V)(e,{customParameters:r});b.sourceJSON=a,b.preferredUrl=(0,u.$x)(),v=(0,i.K)(a.type)}break;default:v=f[t]}if(d[v]&&null==c){var I;const a=await async function(e,r,a){var t,l;let n,o,c,d=!1;switch(r){case"FeatureServer":{const r=await(0,i.Q)(e,{customParameters:a});c=(0,u.$x)(e,{preferredHost:r.preferredHost}),d=!!r.layersJSON,n=r.layersJSON||r.serviceJSON;break}case"SceneServer":{const r=await async function(e,r){var a;const t=await(0,y.V)(e,{customParameters:r}),l=null===(a=t.layers)||void 0===a?void 0:a[0];if(!l)return{serviceInfo:t};try{const{serverUrl:a}=await(0,s.L)(e),l=await(0,y.V)(a,{customParameters:r}).catch(()=>null);return l&&(t.tables=l.tables),{serviceInfo:t,tableServerUrl:a}}catch(n){return{serviceInfo:t}}}(e,a);n=r.serviceInfo,o=r.tableServerUrl;break}default:n=await(0,y.V)(e,{customParameters:a})}const v=null===(t=n)||void 0===t?void 0:t.layers,f=null===(l=n)||void 0===l?void 0:l.tables;return{preferredUrl:c,layers:(null===v||void 0===v?void 0:v.map(e=>({id:e.id})).reverse())||[],tables:(null===f||void 0===f?void 0:f.map(e=>({serverUrl:o,id:e.id})).reverse())||[],layerInfos:d?v:[],tableInfos:d?f:[]}}(e,t,r);if(p&&(b.preferredUrl=a.preferredUrl,b.sublayerInfos=a.layerInfos,b.tableInfos=a.tableInfos),1!==a.layers.length+a.tables.length)b.layers=a.layers,b.tables=a.tables,p&&(null===(I=a.layerInfos)||void 0===I?void 0:I.length)&&(b.sublayerConstructorProvider=await async function(e){if(!e.length)return;const r=new Set,a=[];for(const{type:n}of e)r.has(n)||(r.add(n),a.push(w((0,i.K)(n))));const t=await Promise.all(a),l=new Map;return Array.from(r).forEach((e,r)=>{l.set(e,t[r])}),e=>l.get(e.type)}(a.layerInfos));else if(p||S){var g,P,O,V,C,T;const e=null!==(g=null===(P=a.layerInfos)||void 0===P?void 0:P[0])&&void 0!==g?g:null===(O=a.tableInfos)||void 0===O?void 0:O[0];if(b.layerId=null!==(V=null===(C=a.layers[0])||void 0===C?void 0:C.id)&&void 0!==V?V:null===(T=a.tables[0])||void 0===T?void 0:T.id,b.sourceJSON=e,p){const r=null===e||void 0===e?void 0:e.type;v=(0,i.K)(r)}}}return b.Constructor=await w(v),b}(c,null===r||void 0===r?void 0:r.customParameters),{Constructor:b,layerId:h,sourceJSON:L,parsedUrl:I,layers:g,tables:P}=S;if(g.length+P.length===0)return null!=h&&(v.layerId=h),null!=L&&(v.sourceJSON=L),new b(v);const O=new(0,(await Promise.all([a.e(60239),a.e(16095)]).then(a.bind(a,16095))).default)({title:I.title});return await async function(e,r,a){const t=r.sublayerConstructorProvider;for(const{id:n,serverUrl:o}of r.layers){var l;const s=f(r.sublayerInfos,n),i=p(o,n,s,null!==(l=s&&(null===t||void 0===t?void 0:t(s)))&&void 0!==l?l:r.Constructor,a);e.add(i)}if(r.tables.length){const t=await w("FeatureLayer");r.tables.forEach(l=>{let{id:n,serverUrl:o}=l;const s=p(o,n,f(r.tableInfos,n),t,a);e.tables.add(s)})}}(O,S,v),O}function f(e,r){return e?e.find(e=>{let{id:a}=e;return a===r}):null}function p(e,r,a,l,n){const o=(0,t.A)((0,t.A)({},n),{},{layerId:r});return null!=e&&(o.url=e),null!=a&&(o.sourceJSON=a),"sublayerTitleMode"in l.prototype&&(o.sublayerTitleMode="service-name"),new l(o)}function m(e){return null!=e&&e.hasOwnProperty("store")&&e.hasOwnProperty("id")&&"number"==typeof e.id}async function w(e){return(0,c.S[e])()}},67061:(e,r,a)=>{a.d(r,{V:()=>n});var t=a(89379),l=a(3825);async function n(e,r){const{data:a}=await(0,l.A)(e,{responseType:"json",query:(0,t.A)((0,t.A)({f:"json"},null===r||void 0===r?void 0:r.customParameters),{},{token:null===r||void 0===r?void 0:r.apiKey})});return a}}}]);
//# sourceMappingURL=62544.028108b3.chunk.js.map